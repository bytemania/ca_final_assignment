\clearpage
\section{Appendix}

\subsection{Statistics Description}

So do describe the variables we will  

```{r, echo=TRUE}
feat_desc_num <- function(variable_name, binwidth = 5) {
  summary_stats <- census %>%
    group_by(income) %>%
    summarise(count = n(),
              mean = mean(!!sym(variable_name), na.rm = TRUE),
              median = median(age, na.rm = TRUE),
              min = min(!!sym(variable_name)),
              max = max(!!sym(variable_name), na.rm = TRUE),
              kurtosis = kurtosis(!!sym(variable_name), na.rm = TRUE),
              skewness = skewness(!!sym(variable_name), na.rm = TRUE),
              .groups = "drop") %>%
    ungroup()
  
  g <- ggplot(census, aes(x = !!sym(variable_name), fill = income)) +
       geom_histogram(binwidth = binwidth, position = "dodge", alpha = 0.7) + 
       theme_minimal() +
       labs(title = paste("Frequency of income by ", variable_name)) + 
       theme(plot.title = element_text(hjust = 0.5)) 
  
  grid.draw(g)  
  kable(summary_stats, "latex")
}

feat_desc_cat <- function(variable_name, render_table = TRUE) {
  summary_stats <- census %>%
    group_by(!!sym(variable_name), income) %>%
    summarise(count = n(), .groups = "drop") %>%
    mutate(proportion = count / sum(count)) %>%
    ungroup()  %>%
    mutate(percent = scales::percent(proportion, 1)) 
  
  g <- ggplot(summary_stats, aes(x = !!sym(variable_name), y = proportion, fill = income)) +
    geom_bar(stat = "identity", position = position_dodge()) +
    theme_minimal() +
    labs(title = paste("Proportion of income by ", variable_name)) + 
    theme(plot.title = element_text(hjust = 0.5)) + 
    theme(axis.text.x = element_text(angle = 90, hjust = 1)) 
  
  grid.draw(g)  
  if (render_table) {
    kable(summary_stats, "latex")
  }
}
```


\subsubsection{fnlwgt}

The majority of individuals have a fnlwgt (final weight) value below 200,000, with a 
significant drop-off beyond this range.
Most individuals with higher fnlwgt values earn <=50K.

The histogram is heavily right-skewed, indicating that most individuals have 
lower fnlwgt values.

```{r, echo=TRUE}
feat_desc_num('fnlwgt', 100000)
```



